<node>
  <doctext>&lt;p&gt;
Set 'mobile' mode for this client. Sets a cookie. COOKIE!
&lt;/p&gt;

[{openform}]

[%
    my $mobile_cookie = $query-&gt;cookie('mobile'); 
    my $mobile_param = $query-&gt;param('mobile');
    if ($query-&gt;param('set')) {
      $USER-&gt;{cookie} = $query-&gt;cookie('mobile', $mobile_param || 0);
    } else {
      $query-&gt;param('mobile', $mobile_cookie);
    }

    $query-&gt;checkbox(-name =&gt; 'mobile', -label =&gt; 'mobile')
    . $query-&gt;submit('set')
    . $query-&gt;end_form();
%]

&lt;p&gt;
HTTP host is: [% $ENV{HTTP_HOST} %]
&lt;/p&gt;

&lt;p&gt;
Match is: [% (0  || $ENV{HTTP_HOST} =~ m'^m.everything2'i)?&quot;true&quot;:&quot;false&quot; %]
&lt;/p&gt;

&lt;p&gt;
Key: [%

 my $key = ($query-&gt;cookie('mobile') || $ENV{HTTP_HOST} =~ m'^m.everything2'i)?
     'generalMobileParent_container' : 'generalParent_container';
$key;
%];
&lt;/p&gt;</doctext>
  <node_id>2021836</node_id>
  <type_nodetype>14</type_nodetype>
  <title>set_mobile superdoc</title>
</node>
