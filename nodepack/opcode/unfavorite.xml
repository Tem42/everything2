<node>
  <type_nodetype>415056</type_nodetype>
  <delegate_to></delegate_to>
  <node_id>1930914</node_id>
  <title>unfavorite</title>
  <code>my $node_id = $query -&gt; param(&quot;fave_id&quot;);

my $NODE = getNodeById($node_id);

return unless $NODE;

return if $NODE -&gt; {type_nodetype} != getType(&quot;user&quot;) -&gt; {node_id};
return if $APP-&gt;isGuest($USER);
my $LINKTYPE = getNode('favorite', 'linktype');

my $uid = $$USER{'node_id'};

$DB-&gt;sqlDelete('links', &quot;from_node = $uid AND to_node = $node_id AND linktype = $$LINKTYPE{node_id}&quot;);</code>
</node>
